
\documentclass[a4paper,11pt]{article}
\usepackage[T1]{fontenc}
\usepackage[pdftitle={IF XML metadata format},
            colorlinks=true,
linkcolor=blue,
            bookmarks=true,
bookmarksopen=true,
bookmarksnumbered=false,
pdfhighlight=/P,
pdfauthor={Andrew Hunter},
pdfpagemode={UseOutlines},
pdfstartview=FitH]{hyperref}
\usepackage{times}
\usepackage{verbatim}
\usepackage{bleh}

\newfont{\sst}{cmssbx10 at 24pt}

\setlength{\textwidth}{16cm}
\setlength{\oddsidemargin}{0.5cm}
\setlength{\evensidemargin}{0cm}

\setlength{\topmargin}{-1cm}
\setlength{\headheight}{12pt}
\setlength{\headsep}{6pt}
\setlength{\textheight}{25cm}

\setlength{\parindent}{0cm}
\setlength{\parskip}{1.4ex plus0.5ex minus0.3ex}

\begin{document}

\begin{titlepage}

\begin{flushright}
**Draft**
\end{flushright}

\rule{0cm}{6cm}

\begin{flushright}
\sst
Interactive Fiction XML metadata format\rm\\
\rule{16cm}{1.2mm}\\
Version 0.9\\
\today\\
by Andrew Hunter
\end{flushright}
\vfill

\end{titlepage}

\tableofcontents

\section{Introduction}

The original inspiration of this format is an improvement on the existing interactive fiction
cataloguing system in Zoom. The original design for this used a text file with an arbitrary
format, mainly designed for storing interpreter settings. It was also capable of storing
some limited metadata along with stories, in particular a full title for the story, which
was used in the interpreter's title bar, and also to provide a simple menu of stories.

This format is intended to provide a more advanced indexing system for stories. It
deals specifically with metadata aspects of stories, leaving interpreter configuration
issues up to specific interpreters. This release (0.9) will be implemented in the 1.0.2
release of Zoom. The initial emphasis is on Z-Code stories, but the intention is to allow
the indexing of stories in any of the formats currently in use.

\subsection{Who should use this format?}

Initially, this format will be used by Zoom to provide a searchable list of stories. However,
I hope eventually to encourage archive maintainers and other interpreter authors to make
use of the format. In addition, story authors may want to provide an XML description file
along with their stories.

\section{The format}

All metadata index files are in XML format, and so begin with a <?xml version="1.0"?>
line. The namespace URI is http://www.logicalshift.org.uk/IF/metadata.

\subsection{The root element: ifindex}

This tag specifies the version of the IF metadata format with the 'version' attribute (0.9 for a
file conforming to this document). Usually, this should also specify the namespace URI
and XML schema location.

\begin{example}
  \begin{verbatim}
<ifindex version="0.9"
  xmlns="http://www.logicalshift.org.uk/IF/metadata">
  \end{verbatim}
\end{example}

The <ifindex> tag contains <story> tags, one for each story that is defined in the file.

\subsection{The story tag: story}

The <story> tag is used to specify the data associated with a particular story. It must contain
at least one <identification> section, and may contain one or more metadata tags. It appears
only as a child of the ifindex tag.

\subsection{The story identification tag: identification}

The <identification> tag appears as part of a <story> section, and must contain a <format>
tag identifying the format of the story, and some data providing a unique ID for the story.
It appears only as a child of <story>, which must contain at least one of these tags, but
may contain many if a story has several different versions. The <id> tag is a synonym for
the <identification> tag.

The <format> tag contains textual data identifying the format of the story. This version
of the specification defines identification tags for the following formats:

\begin{description}
\item[zcode] A Z-Code story of the type released by Infocom in the 1980s, or, more
recently, compiled with the Z-Code version of Inform.
\item[glulx] A glulx story of the type compiled by the Glulx version of Inform.
\end{description}

The following additional types are reserved for other existing formats, and may have
identification tags defined in the future:

\begin{description}
\item[tads] A TADS story compiled by the TADS compiler.
\item[hugo] A HUGO story compiled by the HUGO compiler.
\item[alan] An Alan story
\item[adrift] An Adrift story
\item[level9] A story in the Level 9 format
\item[AGT] A story in the AGT format
\item[magscrolls] A story in the magnetic scrolls format
\item[advsys] A story in the advsys format
\end{description}

\subsubsection{Example}

\begin{example}
\begin{verbatim}
<story>
  <identification>
    <format>zcode</format>
    <zcode>
      <serial>871125</serial>
      <release>52</release>
      <checksum>4b37</checksum>
    </zcode>
    <md5>d82484e664a8c328364e9814d1f73c60</md5>
  </identification>
</story>
\end{verbatim}
\end{example}

\subsubsection{Z-Code identification tag: zcode}

The <zcode> tag is used only when the <format> value is 'zcode'. In that case, it must
appear exactly once as a child of  an <indentification> tag. It should contain the following
elements:

\begin{description}
\item[<serial>] The textual serial number of the story. This is usually a six-digit string
specifying the date of release, such as 871125.
\item[<release>] The release number of the story (for example, 52).
\item[<checksum>] (Optional, but recommended) The checksum of the story, in 
hexadecimal format, as specified in the header of the story (for example, 4b37). This field is 
optional, but note that the serial/release numbers are not guaranteed to be unique, especially 
with more recent stories.
\end{description}

\subsubsection{Glulx identification}

ULX format files do not contain any specific story identification information. However,
those compiled by Inform may contain a short 'Info' section located after the header. The
<glulx> section is therefore optional, and only applies to stories compiled with Inform.
An <md5> section should be used to more precisely identify a Glulx story. The <glulx>
section may contain the following tags:

\begin{description}
\item[<serial>] The textual serial number of the story. This is usually a six-digit string
specifying the date of release, such as 030501.
\item[<release>] The release number of the story (for example, 2).
\end{description}

\subsubsection{MD5 identification}

Any story format may have an MD5 section. This is a hexadecimal representation of the
MD5 checksum of a story file. In the case of a Blorb file, this is the MD5 checksum of
the executable portion of the file (the Z-Code or Glulx code file that it contains) rather
than the entire file. There are several utilities available for generating MD5 checksums,
for example the 'md5' utility that comes with OpenSSL. Any story <format> may have
an <md5> section, although the format-specific identification should be used for preference
as it will be easier to write for a story author.

\subsection{The metadata tags}

Each metadata tag may appear zero or one times as a child of  the <story> tag. The following
tags are defined:

\begin{description}
\item[<title>] The title of the story (for example, Zork 1, Solid Gold Edition)
\item[<headline>] The headline of the story (Infocom interactive fiction - a fantasy story)
\item[<author>] The author of the story
\item[<genre>] The genre of the story (Fantasy)
\item[<year>] The year the story was first published (1981)
\item[<group>] The 'group' the story is in (for example, 'Infocom', 'Competition 1998', etc)
\item[<zarfian>] The story's rating according to the 'Zarfian' scale ('Merciful', 'Polite', 
'Tough', 'Nasty', 'Cruel')
\item[<teaser>] The story's teaser text
\\
\item[<comment>] Any user comments on the story
\item[<rating>] The user rating, a value between 0 and 10 where 0=worst and 10=best.
\item[<feelies>] External files, images and data associated with the game
\end{description}

The <comment> and <rating> values are intended to be set only by user interaction in an
interpreter, and so shouldn't be added by story authors or index maintainers. The 'Zarfian'
rating system is described by Andrew Plotkin as follows:

\begin{description}
\item[Merciful] cannot get stuck
\item[Polite] can get stuck or die, but it's immediately obvious that you're stuck or dead
\item[Tough] can get stuck, but it's immediately obvious that you're about to do something 
irrevocable
\item[Nasty] can get stuck, but when you do something irrevocable, it's clear 
\item[Cruel] can get stuck by doing something which isn't obviously irrevocable (even after the act)
\end{description}

Comments and teasers may contain newlines, specified by a <br /> tag: all other tags are
single line values. No tag may appear more than once. The genre can be any textual value,
but Zoom suggests the following list of 'standard' genres:

\begin{itemize}
\item Fantasy
\item Science fiction
\item Horror
\item Fairy tale
\item Surreal
\item Mystery
\item Romance
\item Historical
\item Humour
\item Parody
\item Speed-IF
\item Arcade
\item Interpreter abuse
\end{itemize}

\subsection{The <feelies> tag}

This tag is used to associate files and other forms of data with the game. Usually this data is
provided as URL references to files. Relative references are permissible, so a game author
can provide a game file, feelies, and a .iFiction file all as part of one package. The following
tags can be supplied in the feelies section:

\begin{description}
\item[icon] A miniature picture associated with the game. This should be a base 64 encoded 
PNG file of 128x128 size, and can be used by an interpreter to display an image associated with
a game file.
\item[image] A URL of an image associated with the game. Images should be of PNG or
JPEG format.
\item[pdf] A URL of a PDF document associated with the game
\item[url] Specifies the URL of the game file. This can be used by archive or review sites to
provide information on where to obtain a game.
\end{description}

All of these tags should have a 'title' attribute, indicating a name that should be displayed
in association with the feelie.

\end{document}
